<!DOCTYPE html>
<html>
	<head>
		<title>NLB Handbook</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	</head>
	<body>
		<h1>NLB Handbook</h1>
		<p>Welcome to NLB</p>
		
		<h2>Installation</h2>
		<h3>Requirements</h3>
		<ul>
			<li>Linux/FreeBSD (no Windows support at this time)</li>
			<li>PHP 5.3 or higher with PDO mysql driver working</li>
			<li>Apache2 with mod_rewrite enabled</li>
			<li>MySQL 5.0+</li>
			<li>YUI Compressor 2.4.7+ installed on your server</li>
		</ul>
		<p>Installing NLB is not too difficult. Here are the steps to install:</p>
		<ul>
			<li>Download the NLB code and put it on your server somewhere.</li>
			<li>Create a new VirtualHost that points to the <code>www</code> folder.</li>
			<li>Copy the <code>sites/default/config/example.config.inc.php</code> file to <code>sites/default/config/config.inc.php</code>.</li>
			<li>Edit the new <code>config.inc.php</code> file to have the necessary settings for your application.</li>
			<li>Visit <code>http://&lt;yoursite.com&gt;/install.php</code> changing <code>&lt;yoursite.com&gt;</code> to your actual domain name.</li>
			<li>Follow the on-screen instructions to install NLB.</li>
			<li>Make sure the following directories exist (relative to the NLB root folder) and that they are writable by apache:
				<ul>
					<li><code>logs</code></li>
					<li><code>www/combined-assets</code></li>
					<li><code>smarty/templates_c</code></li>
					<li><code>smarty/cache</code></li>
				</ul>
			</li>
		</ul>
		
		<h2>Routes</h2>
		<p>In NLB, routes are used to create a mapping between a particular path and a controller that should handle that path. Access
			restrictions can also be added to a route preventing certain users from accessing certain areas of your application. NLB has a list
			of it's own routes in the <code>config/nlb_routes.inc.php</code> file. To define your own routes you must use the <code>sites/default/config/routes.inc.php</code> file.
			The routes in <code>sites/default/config/routes.inc.php</code> will override routes defined in <code>config/nlb_routes.inc.php</code>.
			This allows you to change NLB's default behavior if desired.
			Below is a simple <code>routes.inc.php</code> file defining a route that would be used for a simple blog post listing:</p>
		<pre><code>&lt;?php
$routes = array(
	'blog' => array(
		'handler' => 'blog.php?action=list',
		'access' => array('anonymous user'),
	),
);</code></pre>
		<p>Given that defined route, NLB will route requests to <code>/blog</code> to the <code>blog.php</code> controller and will
			set <code>$_GET['action']</code> to <code>'list'</code>. It's important to note that any query string parameters in your handler
			definition will be automatically merged with the <code>$_GET</code> array, overwriting any existing keys in the <code>$_GET</code>
			array. Also, in keeping with PHP's standards, the query string parameters in your handler definition will also be automatically
			merged with the <code>$_REQUEST</code> array for consistency. Controllers in the <code>handlers</code> directory can be organized
			into subdirectories if desired. This helps to keep the code for larger sites more manageable.
		</p>
		
		<h3>Dynamic Routes</h3>
		<p>When defining a route, it is possible to use a wildcard in your path definition. Using a wildcard allows you to map multiple
			similar paths to a single controller. The value of the wildcard can then be passed to the controller. <strong>Wildcards can be alphanumeric
			and may also contain underscores</strong>. There can be multiple wildcards in a path definition. Take a look at this route
			definition which would be used for viewing specific blog posts:</p>
		<pre><code>&lt;?php
$routes = array(
	'blog/view-%post_id' => array(
		'handler' => 'blog.php?action=viewpost&amp;id=%post_id',
		'access' => array('anonymous user'),
	),
);</code></pre>
		<p>Using this defined route, NLB will route requests to paths like <code>/blog/view-3</code> and <code>/blog/view-7</code> to the
			<code>blog.php</code> controller and will set <code>$_GET['action']</code> to <code>'viewpost'</code> and <code>$_GET['id']</code>
			to <code>'3'</code> or <code>'7'</code> respectively.
		</p>
		
		<h2>Templates</h2>
		<p>When rendering templates, NLB has been configured to first search for templates in the <code>sites/default/themes/&lt;your_theme&gt;/</code> directory.
			If the template does not exist there, the <code>smarty/nlb_templates</code> directory is searched. With this configuration, you
			can override any default template that comes with NLB by providing your own version of the template. Just make sure the file has
			the exact same name as the NLB default template.
		</p>
		
		<h2>Multi-Site Configuration</h2>
		<p>
			NLB has a feature that allows you to run multiple websites from the same NLB core. The way this is done is by copying the
			<code>sites/default</code> directory to <code>sites/&lt;your_site&gt;</code> where &lt;your_site&gt; is the hostname for the
			site you are configuring as a multi-site. NLB will try to match the hostname in the request to the name of one of the directories
			in the <code>sites</code> directory. If a match is found, the config file for that directory will be used instead of the one in the
			<code>sites/default/config</code> directory. If no match is found, NLB defaults to using the <code>sites/default</code> directory.
			NLB will also try to do partial matches against the hostname to try and find a matching multi-site directory. Following are some
			examples of how NLB matches hostnames to directories in <code>sites</code>. Given the hostname
			<code>www.example.com</code> NLB will look for the following directories in <code>sites</code> (in this order):
		</p>
		<ul>
			<li>www.example.com</li>
			<li>example.com</li>
			<li>www.example</li>
			<li>example</li>
			<li>default</li>
		</ul>
		<p>
			Given the hostname <code>example.com</code> NLB will look for the following directories in <code>sites</code> (in this order):
		</p>
		<ul>
			<li>example.com</li>
			<li>example</li>
			<li>com</li>
			<li>default</li>
		</ul>
	</body>
</html>
